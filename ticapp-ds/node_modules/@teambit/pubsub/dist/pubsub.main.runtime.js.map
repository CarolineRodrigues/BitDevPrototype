{"version":3,"sources":["pubsub.main.runtime.ts"],"names":["PubsubMain","topicUUID","topicMap","sub","callback","createOrGetTopic","push","pub","event","forEach","unsubscribeAll","topicId","provider","MainRuntime","PubsubAspect","addRuntime"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEO,MAAMA,UAAN,CAAiB;AAAA;AAAA,sDACH,EADG;AAAA,8DAGMC,SAAD,IAAe;AACxC,WAAKC,QAAL,CAAcD,SAAd,IAA2B,KAAKC,QAAL,CAAcD,SAAd,KAA4B,EAAvD;AACD,KALqB;AAAA;;AAOfE,EAAAA,GAAG,CAACF,SAAD,EAAYG,QAAZ,EAAsB;AAC9B,SAAKC,gBAAL,CAAsBJ,SAAtB;AACA,SAAKC,QAAL,CAAcD,SAAd,EAAyBK,IAAzB,CAA8BF,QAA9B;AACD;;AAEMG,EAAAA,GAAG,CAACN,SAAD,EAAYO,KAAZ,EAAsC;AAC9C,SAAKH,gBAAL,CAAsBJ,SAAtB;AACA,SAAKC,QAAL,CAAcD,SAAd,EAAyBQ,OAAzB,CAAkCL,QAAD,IAAcA,QAAQ,CAACI,KAAD,CAAvD;AACD;;AAEDE,EAAAA,cAAc,CAACC,OAAD,EAAkB;AAC9B,WAAO,KAAKT,QAAL,CAAcS,OAAd,CAAP;AACD;;AAIoB,eAARC,QAAQ,GAAG;AACtB,WAAO,IAAIZ,UAAJ,EAAP;AACD;;AAzBqB;;;gCAAXA,U,aAqBMa,kB;;AAOnBC,uBAAaC,UAAb,CAAwBf,UAAxB","sourcesContent":["import { MainRuntime } from '@teambit/cli';\n\nimport { BitBaseEvent } from './bit-base-event';\nimport { PubsubAspect } from './pubsub.aspect';\n\nexport class PubsubMain {\n  private topicMap = {};\n\n  private createOrGetTopic = (topicUUID) => {\n    this.topicMap[topicUUID] = this.topicMap[topicUUID] || [];\n  };\n\n  public sub(topicUUID, callback) {\n    this.createOrGetTopic(topicUUID);\n    this.topicMap[topicUUID].push(callback);\n  }\n\n  public pub(topicUUID, event: BitBaseEvent<any>) {\n    this.createOrGetTopic(topicUUID);\n    this.topicMap[topicUUID].forEach((callback) => callback(event));\n  }\n\n  unsubscribeAll(topicId: string) {\n    delete this.topicMap[topicId];\n  }\n\n  static runtime = MainRuntime;\n\n  static async provider() {\n    return new PubsubMain();\n  }\n}\n\nPubsubAspect.addRuntime(PubsubMain);\n"]}