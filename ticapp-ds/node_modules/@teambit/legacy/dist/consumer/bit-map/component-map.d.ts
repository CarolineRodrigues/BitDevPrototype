import { BitId, BitIds } from '../../bit-id';
import { COMPONENT_ORIGINS } from '../../constants';
import { RemoteLaneId } from '../../lane-id/lane-id';
import { PathLinux, PathLinuxRelative, PathOsBased, PathOsBasedRelative } from '../../utils/path';
import Consumer from '../consumer';
export declare type ComponentOrigin = keyof typeof COMPONENT_ORIGINS;
export declare type Config = {
    [aspectId: string]: Record<string, any> | '-';
};
export declare type ComponentMapFile = {
    name: string;
    relativePath: PathLinux;
    test: boolean;
};
export declare type NextVersion = {
    version: 'patch' | 'minor' | 'major' | 'prerelease' | string;
    preRelease?: string;
    message?: string;
    username?: string;
    email?: string;
};
declare type LaneVersion = {
    remoteLane: RemoteLaneId;
    version: string;
};
export declare type ComponentMapData = {
    id: BitId;
    files: ComponentMapFile[];
    defaultScope?: string;
    mainFile: PathLinux;
    rootDir?: PathLinux;
    trackDir?: PathLinux;
    origin: ComponentOrigin;
    originallySharedDir?: PathLinux;
    wrapDir?: PathLinux;
    exported?: boolean;
    onLanesOnly: boolean;
    lanes?: LaneVersion[];
    defaultVersion?: string;
    isAvailableOnCurrentLane?: boolean;
    nextVersion?: NextVersion;
    config?: Config;
};
export declare type PathChange = {
    from: PathLinux;
    to: PathLinux;
};
export default class ComponentMap {
    id: BitId;
    files: ComponentMapFile[];
    defaultScope?: string;
    mainFile: PathLinux;
    rootDir?: PathLinux;
    trackDir: PathLinux | undefined;
    origin: ComponentOrigin;
    originallySharedDir: PathLinux | undefined;
    wrapDir: PathLinux | undefined;
    markBitMapChangedCb: Function;
    exported: boolean | null | undefined;
    onLanesOnly?: boolean | undefined;
    lanes: LaneVersion[];
    defaultVersion?: string | null;
    isAvailableOnCurrentLane?: boolean | undefined;
    nextVersion?: NextVersion;
    recentlyTracked?: boolean;
    scope?: string | null;
    version?: string;
    noFilesError?: Error;
    config?: {
        [aspectId: string]: Record<string, any> | '-';
    };
    constructor({ id, files, defaultScope, mainFile, rootDir, trackDir, origin, originallySharedDir, wrapDir, onLanesOnly, lanes, defaultVersion, isAvailableOnCurrentLane, nextVersion, config, }: ComponentMapData);
    static fromJson(componentMapObj: Omit<ComponentMapData, 'lanes'> & {
        lanes: Array<{
            remoteLane: string;
            version: string;
        }>;
    }): ComponentMap;
    toPlainObject(isLegacy: boolean): Record<string, any>;
    private configToObject;
    static getPathWithoutRootDir(rootDir: PathLinux, filePath: PathLinux): PathLinux;
    static changeFilesPathAccordingToItsRootDir(existingRootDir: PathLinux, files: ComponentMapFile[]): PathChange[];
    setMarkAsChangedCb(markAsChangedBinded: Function): void;
    _findFile(fileName: PathLinux): ComponentMapFile | undefined;
    changeRootDirAndUpdateFilesAccordingly(newRootDir: PathLinuxRelative): void;
    addRootDirToDistributedFiles(rootDir: PathOsBased): void;
    updateFileLocation(fileFrom: PathOsBased, fileTo: PathOsBased): PathChange[];
    updateDirLocation(dirFrom: PathOsBasedRelative, dirTo: PathOsBasedRelative): PathChange[];
    getFilesRelativeToConsumer(): PathLinux[];
    getAllFilesPaths(): PathLinux[];
    getFilesGroupedByBeingTests(): {
        allFiles: string[];
        nonTestsFiles: string[];
        testsFiles: string[];
    };
    /**
     * if one of the added files is outside of the trackDir, remove the trackDir attribute
     */
    removeTrackDirIfNeeded(): void;
    /**
     * directory to track for changes (such as files added/renamed)
     */
    getTrackDir(): PathLinux | undefined;
    /**
     * this.rootDir is not defined for author. instead, the current workspace is the rootDir
     * also, for imported environments (compiler/tester) components the rootDir is empty
     */
    getRootDir(): PathLinuxRelative;
    hasRootDir(): boolean;
    /**
     * directory of the component (root / track)
     * for legacy (bit.json) workspace, it can be undefined for authored when individual files were added
     */
    getComponentDir(): PathLinux | undefined;
    doesAuthorHaveRootDir(): boolean;
    /**
     * this.id.version should indicate the currently used version, regardless of the lane.
     * on the filesystem, id.version is saved according to the main, so it needs to be changed.
     * @param currentRemote
     * @param currentLaneIds
     */
    updatePerLane(currentRemote?: RemoteLaneId | null, currentLaneIds?: BitIds | null): void;
    addLane(remoteLaneId: RemoteLaneId, version: string): void;
    /**
     * in case new files were created in the track-dir directory, add them to the component-map
     * so then they'll be tracked by bitmap.
     * this doesn't get called on Harmony, it's for legacy only.
     */
    trackDirectoryChangesLegacy(consumer: Consumer, id: BitId): Promise<void>;
    /**
     * if the component dir has changed since the last tracking, re-scan the component-dir to get the
     * updated list of the files
     */
    trackDirectoryChangesHarmony(consumer: Consumer, id: BitId): Promise<void>;
    updateNextVersion(nextVersion: NextVersion): void;
    clearNextVersion(): void;
    removeFiles(files: ComponentMapFile[]): void;
    sort(): void;
    clone(): ComponentMap;
    validate(): void;
}
export {};
