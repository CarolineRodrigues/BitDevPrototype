{"version":3,"sources":["react-elements.main.runtime.ts"],"names":["ReactElementsMain","constructor","elements","createTask","storageResolver","getWrapperTemplateFn","opts","getWrapperTemplateOptsWithDefaults","getWebpackTransformers","baseConfig","baseProdConfig","baseElementsTransformers","defaultTransformer","configMutator","merged","merge","Object","assign","elementsPrefix","provider","ElementsAspect","MainRuntime","ReactElementsAspect","addRuntime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEO,MAAMA,iBAAN,CAAwB;AAC7BC,EAAAA,WAAW,CAASC,QAAT,EAAiC;AAAA,SAAxBA,QAAwB,GAAxBA,QAAwB;AAAE;;AAC9CC,EAAAA,UAAU,CAACC,eAAD,EAA4C;AACpD,WAAO,KAAKF,QAAL,CAAcC,UAAd,CAAyBC,eAAzB,CAAP;AACD;;AAEDC,EAAAA,oBAAoB,CAACC,IAAD,EAAiC;AACnD,WAAO,oDAAqB,KAAKC,kCAAL,CAAwCD,IAAI,IAAI,EAAhD,CAArB,CAAP;AACD;;AAEDE,EAAAA,sBAAsB,GAA+B;AACnD,UAAMC,UAAU,GAAG,8BAAyB,IAAzB,CAAnB;AACA,UAAMC,cAAc,GAAG,mCAAvB;AACA,UAAMC,wBAAwB,GAAG,KAAKT,QAAL,CAAcM,sBAAd,EAAjC;;AAEA,UAAMI,kBAA4C,GAAIC,aAAD,IAAmB;AACtE,YAAMC,MAAM,GAAGD,aAAa,CAACE,KAAd,CAAoB,CAACN,UAAD,EAAaC,cAAb,CAApB,CAAf;AACA,aAAOI,MAAP;AACD,KAHD;;AAIA,WAAO,CAAC,GAAGH,wBAAJ,EAA8BC,kBAA9B,CAAP;AACD;;AAEOL,EAAAA,kCAAkC,CAACD,IAAD,EAAgD;AACxF,WAAOU,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB;AAAEC,MAAAA,cAAc,EAAE;AAAlB,KAAlB,EAA2CZ,IAA3C,CAAP;AACD;;AAKoB,eAARa,QAAQ,CAAC,CAACjB,QAAD,CAAD,EAA6B;AAChD,WAAO,IAAIF,iBAAJ,CAAsBE,QAAtB,CAAP;AACD;;AA/B4B;;;gCAAlBF,iB,WA0BI,E;gCA1BJA,iB,kBA2BW,CAACoB,mBAAD,C;gCA3BXpB,iB,aA4BMqB,kB;;AAMnBC,qCAAoBC,UAApB,CAA+BvB,iBAA/B","sourcesContent":["import { MainRuntime } from '@teambit/cli';\nimport { ArtifactStorageResolver } from '@teambit/builder';\nimport { WebpackConfigTransformer } from '@teambit/webpack';\nimport ElementsAspect, { ElementsMain } from '@teambit/elements';\nimport { GetWrapperOpts, getWrapperTemplateFn } from './element-wrapper-template';\nimport basePreviewConfigFactory from './webpack/webpack.config.base';\nimport basePreviewProdConfigFactory from './webpack/webpack.config.base.prod';\n\nimport { ReactElementsAspect } from './react-elements.aspect';\n\nexport class ReactElementsMain {\n  constructor(private elements: ElementsMain) {}\n  createTask(storageResolver?: ArtifactStorageResolver) {\n    return this.elements.createTask(storageResolver);\n  }\n\n  getWrapperTemplateFn(opts?: Partial<GetWrapperOpts>) {\n    return getWrapperTemplateFn(this.getWrapperTemplateOptsWithDefaults(opts || {}));\n  }\n\n  getWebpackTransformers(): WebpackConfigTransformer[] {\n    const baseConfig = basePreviewConfigFactory(true);\n    const baseProdConfig = basePreviewProdConfigFactory();\n    const baseElementsTransformers = this.elements.getWebpackTransformers();\n\n    const defaultTransformer: WebpackConfigTransformer = (configMutator) => {\n      const merged = configMutator.merge([baseConfig, baseProdConfig]);\n      return merged;\n    };\n    return [...baseElementsTransformers, defaultTransformer];\n  }\n\n  private getWrapperTemplateOptsWithDefaults(opts: Partial<GetWrapperOpts>): GetWrapperOpts {\n    return Object.assign({}, { elementsPrefix: 'x' }, opts);\n  }\n\n  static slots = [];\n  static dependencies = [ElementsAspect];\n  static runtime = MainRuntime;\n  static async provider([elements]: [ElementsMain]) {\n    return new ReactElementsMain(elements);\n  }\n}\n\nReactElementsAspect.addRuntime(ReactElementsMain);\n"]}