{"version":3,"sources":["component-dependency.ts"],"names":["TYPE","ComponentDependency","BaseDependency","constructor","_componentId","_isExtension","_packageName","id","version","lifecycle","source","_type","componentId","isExtension","packageName","getPackageName","setVersion","newVersion","newComponentId","changeVersion","splittedId","split","length","newId","serialize","serialized","Object","assign","_legacy","toManifest"],"mappings":";;;;;;;;;AAIA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGO,MAAMA,IAAI,GAAG,WAAb;;;AAQP;AACO,MAAMC,mBAAN,SAAkCC,gCAAlC,CAAiD;AACtDC,EAAAA,WAAW,CACDC,YADC,EAEDC,YAFC,EAGDC,YAHC,EAITC,EAJS,EAKTC,OALS,EAMTC,SANS,EAOTC,MAPS,EAQT;AACA,UAAMH,EAAN,EAAUC,OAAV,EAAmBC,SAAnB,EAA8BC,MAA9B;AADA,SAPQN,YAOR,GAPQA,YAOR;AAAA,SANQC,YAMR,GANQA,YAMR;AAAA,SALQC,YAKR,GALQA,YAKR;AAEA,SAAKK,KAAL,GAAaX,IAAb;AACD;;AAEc,MAAXY,WAAW,GAAG;AAChB,WAAO,KAAKR,YAAZ;AACD;;AAEc,MAAXS,WAAW,GAAG;AAChB,WAAO,KAAKR,YAAZ;AACD;;AAEc,MAAXS,WAAW,GAAG;AAChB,WAAO,KAAKR,YAAZ;AACD;;AAEDS,EAAAA,cAAc,GAAG;AACf,WAAO,KAAKD,WAAZ;AACD;;AAEDE,EAAAA,UAAU,CAACC,UAAD,EAAqB;AAC7B,UAAMD,UAAN,CAAiBC,UAAjB;AACA,UAAMC,cAAc,GAAG,KAAKN,WAAL,CAAiBO,aAAjB,CAA+BF,UAA/B,CAAvB;AACA,SAAKb,YAAL,GAAoBc,cAApB;AACA,UAAME,UAAU,GAAG,KAAKb,EAAL,CAAQc,KAAR,CAAc,GAAd,CAAnB;;AACA,QAAID,UAAU,CAACE,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,YAAMC,KAAK,GAAI,GAAEH,UAAU,CAAC,CAAD,CAAI,IAAGH,UAAW,EAA7C;AACA,WAAKV,EAAL,GAAUgB,KAAV;AACD;AACF,GAvCqD,CAyCtD;;;AACAC,EAAAA,SAAS,GAAiE;AACxE,UAAMC,UAAU,GAAIC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,MAAMH,SAAN,EAAlB,EAAqC;AACvDZ,MAAAA,WAAW,EAAE,KAAKA,WAAL,CAAiBgB,OAAjB,CAAyBJ,SAAzB,EAD0C;AAEvDX,MAAAA,WAAW,EAAE,KAAKA,WAFqC;AAGvDC,MAAAA,WAAW,EAAE,KAAKA;AAHqC,KAArC,CAApB;AAKA,WAAOW,UAAP;AACD;;AAEDI,EAAAA,UAAU,GAAuB;AAAA;;AAC/B,UAAMf,WAAW,2BAAG,KAAKC,cAAR,yDAAG,+BAApB;AACA,UAAMP,OAAO,GAAG,KAAKA,OAArB;AACA,WAAO;AACLM,MAAAA,WADK;AAELN,MAAAA;AAFK,KAAP;AAID;;AA1DqD","sourcesContent":["import type { ComponentID } from '@teambit/component-id';\nimport type { BitIdProps } from '@teambit/legacy-bit-id';\n\nimport { SerializedDependency, DependencyLifecycleType, DependencyManifest } from '../dependency';\nimport { BaseDependency } from '../base-dependency';\nimport { DependencySource } from '../../policy/variant-policy/variant-policy';\n\nexport const TYPE = 'component';\n\nexport interface SerializedComponentDependency extends SerializedDependency {\n  componentId: BitIdProps;\n  isExtension: boolean;\n  packageName: string;\n}\n\n// TODO: think about where is the right place to put this\nexport class ComponentDependency extends BaseDependency {\n  constructor(\n    private _componentId: ComponentID,\n    private _isExtension: boolean,\n    private _packageName: string,\n    id: string,\n    version: string,\n    lifecycle: DependencyLifecycleType,\n    source?: DependencySource\n  ) {\n    super(id, version, lifecycle, source);\n    this._type = TYPE;\n  }\n\n  get componentId() {\n    return this._componentId;\n  }\n\n  get isExtension() {\n    return this._isExtension;\n  }\n\n  get packageName() {\n    return this._packageName;\n  }\n\n  getPackageName() {\n    return this.packageName;\n  }\n\n  setVersion(newVersion: string) {\n    super.setVersion(newVersion);\n    const newComponentId = this.componentId.changeVersion(newVersion);\n    this._componentId = newComponentId;\n    const splittedId = this.id.split('@');\n    if (splittedId.length === 2) {\n      const newId = `${splittedId[0]}@${newVersion}`;\n      this.id = newId;\n    }\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  serialize<SerializedComponentDependency>(): SerializedComponentDependency {\n    const serialized = (Object.assign({}, super.serialize(), {\n      componentId: this.componentId._legacy.serialize(),\n      isExtension: this.isExtension,\n      packageName: this.packageName,\n    }) as unknown) as SerializedComponentDependency;\n    return serialized;\n  }\n\n  toManifest(): DependencyManifest {\n    const packageName = this.getPackageName?.();\n    const version = this.version;\n    return {\n      packageName,\n      version,\n    };\n  }\n}\n"]}