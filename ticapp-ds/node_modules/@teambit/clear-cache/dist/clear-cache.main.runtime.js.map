{"version":3,"sources":["clear-cache.main.runtime.ts"],"names":["ClearCacheMain","constructor","workspace","clearCache","clearRemoteCache","remote","remoteObj","consumer","result","action","ClearCacheAction","name","provider","cli","scope","community","clearCacheMain","register","ClearCacheCmd","getDocsDomain","ExternalActions","externalActions","push","WorkspaceAspect","CLIAspect","ScopeAspect","CommunityAspect","MainRuntime","ClearCacheAspect","addRuntime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEO,MAAMA,cAAN,CAAqB;AAC1BC,EAAAA,WAAW,CAASC,SAAT,EAAgC;AAAA,SAAvBA,SAAuB,GAAvBA,SAAuB;AAAE;;AAE7B,QAAVC,UAAU,GAAsB;AACpC,WAAO,6BAAP;AACD;;AAEqB,QAAhBC,gBAAgB,CAACC,MAAD,EAAiB;AAAA;;AACrC,UAAMC,SAAS,GAAG,MAAM,gCAAgBD,MAAhB,qBAAwB,KAAKH,SAA7B,oDAAwB,gBAAgBK,QAAxC,CAAxB;AACA,UAAMC,MAAM,GAAG,MAAMF,SAAS,CAACG,MAAV,CAAiBC,qCAAiBC,IAAlC,EAAwC,EAAxC,CAArB;AACA,WAAOH,MAAP;AACD;;AAKoB,eAARI,QAAQ,CAAC,CAACV,SAAD,EAAYW,GAAZ,EAAiBC,KAAjB,EAAwBC,SAAxB,CAAD,EAAqF;AACxG,UAAMC,cAAc,GAAG,IAAIhB,cAAJ,CAAmBE,SAAnB,CAAvB;AACAW,IAAAA,GAAG,CAACI,QAAJ,CAAa,KAAIC,wBAAJ,EAAkBF,cAAlB,EAAkCD,SAAS,CAACI,aAAV,EAAlC,CAAb;;AACAC,8BAAgBC,eAAhB,CAAgCC,IAAhC,CAAqC,KAAIZ,oCAAJ,EAAqBI,KAArB,CAArC;;AAEA,WAAOE,cAAP;AACD;;AAtByB;;;gCAAfhB,c,WAaI,E;gCAbJA,c,kBAcW,CAACuB,oBAAD,EAAkBC,gBAAlB,EAA6BC,gBAA7B,EAA0CC,4BAA1C,C;gCAdX1B,c,aAeM2B,kB;;AAUnBC,+BAAiBC,UAAjB,CAA4B7B,cAA5B","sourcesContent":["import { CLIAspect, CLIMain, MainRuntime } from '@teambit/cli';\nimport WorkspaceAspect, { Workspace } from '@teambit/workspace';\nimport ScopeAspect, { ScopeMain } from '@teambit/scope';\nimport { clearCache } from '@teambit/legacy/dist/api/consumer';\nimport { ExternalActions } from '@teambit/legacy/dist/api/scope/lib/action';\nimport { CommunityAspect } from '@teambit/community';\nimport type { CommunityMain } from '@teambit/community';\n\nimport getRemoteByName from '@teambit/legacy/dist/remotes/get-remote-by-name';\nimport ClearCacheCmd from './clear-cache-cmd';\nimport { ClearCacheAspect } from './clear-cache.aspect';\nimport { ClearCacheAction } from './clear-cache-action';\n\nexport class ClearCacheMain {\n  constructor(private workspace?: Workspace) {}\n\n  async clearCache(): Promise<string[]> {\n    return clearCache();\n  }\n\n  async clearRemoteCache(remote: string) {\n    const remoteObj = await getRemoteByName(remote, this.workspace?.consumer);\n    const result = await remoteObj.action(ClearCacheAction.name, {});\n    return result;\n  }\n\n  static slots = [];\n  static dependencies = [WorkspaceAspect, CLIAspect, ScopeAspect, CommunityAspect];\n  static runtime = MainRuntime;\n  static async provider([workspace, cli, scope, community]: [Workspace, CLIMain, ScopeMain, CommunityMain]) {\n    const clearCacheMain = new ClearCacheMain(workspace);\n    cli.register(new ClearCacheCmd(clearCacheMain, community.getDocsDomain()));\n    ExternalActions.externalActions.push(new ClearCacheAction(scope));\n\n    return clearCacheMain;\n  }\n}\n\nClearCacheAspect.addRuntime(ClearCacheMain);\n"]}