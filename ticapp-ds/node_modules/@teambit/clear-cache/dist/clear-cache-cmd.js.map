{"version":3,"sources":["clear-cache-cmd.ts"],"names":["ClearCacheCmd","constructor","clearCache","docsDomain","extendedDescription","report","arg","remote","success","clearRemoteCache","chalk","green","red","cacheCleared","title","output","map","str","join","bold"],"mappings":";;;;;;;;;;;;;;;;;;;;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGe,MAAMA,aAAN,CAAuC;AAUpDC,EAAAA,WAAW,CAASC,UAAT,EAA6CC,UAA7C,EAAiE;AAAA,SAAxDD,UAAwD,GAAxDA,UAAwD;AAAA,SAApBC,UAAoB,GAApBA,UAAoB;AAAA,kDATrE,aASqE;AAAA,yDAR9D,iDAQ8D;AAAA,mDAPpE,SAOoE;AAAA;AAAA,mDALpE,IAKoE;AAAA,qDAJlE,CAAC,CAAC,GAAD,EAAM,sBAAN,EAA8B,wCAA9B,CAAD,CAIkE;AAAA,oDAHnE,KAGmE;AAAA,2DAF5D,IAE4D;AAC1E,SAAKC,mBAAL,GAA4B;AAChC;AACA;AACA;AACA,UAAUD,UAAW,2BAJjB;AAKD;;AAEW,QAANE,MAAM,CAACC,GAAD,EAAM;AAAEC,IAAAA;AAAF,GAAN,EAAwD;AAClE,QAAIA,MAAJ,EAAY;AACV,YAAMC,OAAO,GAAG,MAAM,KAAKN,UAAL,CAAgBO,gBAAhB,CAAiCF,MAAjC,CAAtB;;AACA,UAAIC,OAAJ,EAAa;AACX,eAAOE,iBAAMC,KAAN,CAAa,sCAAqCJ,MAAO,GAAzD,CAAP;AACD;;AACD,aAAOG,iBAAME,GAAN,CAAW,iCAAgCL,MAAO,GAAlD,CAAP;AACD;;AACD,UAAMM,YAAY,GAAG,MAAM,KAAKX,UAAL,CAAgBA,UAAhB,EAA3B;AACA,UAAMY,KAAK,GAAG,2CAAd;AACA,UAAMC,MAAM,GAAGF,YAAY,CAACG,GAAb,CAAkBC,GAAD,IAAU,OAAMA,GAAI,EAArC,EAAwCC,IAAxC,CAA6C,IAA7C,CAAf;AACA,WAAOR,iBAAMC,KAAN,CAAa,GAAED,iBAAMS,IAAN,CAAWL,KAAX,CAAkB,KAAIC,MAAO,EAA5C,CAAP;AACD;;AA9BmD","sourcesContent":["import { Command, CommandOptions } from '@teambit/cli';\nimport chalk from 'chalk';\nimport { ClearCacheMain } from './clear-cache.main.runtime';\n\nexport default class ClearCacheCmd implements Command {\n  name = 'clear-cache';\n  description = \"clears Bit's cache from current working machine\";\n  group = 'general';\n  extendedDescription: string;\n  alias = 'cc';\n  options = [['r', 'remote <remote-name>', 'clear memory cache from a remote scope']] as CommandOptions;\n  loader = false;\n  skipWorkspace = true;\n\n  constructor(private clearCache: ClearCacheMain, private docsDomain: string) {\n    this.extendedDescription = `The following gets removed by this command:\n1) V8 compiled code (generated the first time Bit is loaded by v8-compile-cache package)\n2) components cache on the filesystem (mainly the dependencies graph and docs)\n3) scope's index file, which maps the component-id:object-hash\nhttps://${docsDomain}/workspace/clearing-cache`;\n  }\n\n  async report(arg, { remote }: { remote?: string }): Promise<string> {\n    if (remote) {\n      const success = await this.clearCache.clearRemoteCache(remote);\n      if (success) {\n        return chalk.green(`successfully cleaned the cache of \"${remote}\"`);\n      }\n      return chalk.red(`failed cleaning the cache of \"${remote}\"`);\n    }\n    const cacheCleared = await this.clearCache.clearCache();\n    const title = 'the following cache(s) have been cleared:';\n    const output = cacheCleared.map((str) => `  âœ” ${str}`).join('\\n');\n    return chalk.green(`${chalk.bold(title)}\\n${output}`);\n  }\n}\n"]}