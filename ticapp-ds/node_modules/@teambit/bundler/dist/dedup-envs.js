"use strict";

require("core-js/modules/es.regexp.exec.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.dedupEnvs = dedupEnvs;

// de-duping dev servers by the amount of type the dev server configuration was overridden by envs.
function dedupEnvs(contexts, dedicatedEnvDevServers) {
  const groupedEnvs = {};
  contexts.forEach(context => {
    const envId = getEnvId(context, dedicatedEnvDevServers);
    if (!envId) return;
    if (!(envId in groupedEnvs)) groupedEnvs[envId] = [];
    groupedEnvs[envId].push(context);
  });
  return groupedEnvs;
}

function getEnvId(context, dedicatedServers) {
  var _context$env;

  const id = context.id.split('@')[0];

  if (dedicatedServers !== null && dedicatedServers !== void 0 && dedicatedServers.includes(id)) {
    return context.id;
  }

  return (_context$env = context.env) === null || _context$env === void 0 ? void 0 : _context$env.getDevEnvId(context);
}

//# sourceMappingURL=dedup-envs.js.map