{"version":3,"sources":["pack.task.ts"],"names":["PackTask","constructor","aspectId","packer","logger","execute","context","capsules","capsuleNetwork","seedersCapsules","info","length","packResults","packMultipleCapsules","override","packArtifactsDefs","getArtifactDefInCapsule","componentsResults","artifacts"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAIA;AACA;AACA;AACO,MAAMA,QAAN,CAAoC;AAGzCC,EAAAA,WAAW,CAAUC,QAAV,EAAoCC,MAApC,EAA4DC,MAA5D,EAA4E;AAAA,SAAlEF,QAAkE,GAAlEA,QAAkE;AAAA,SAAxCC,MAAwC,GAAxCA,MAAwC;AAAA,SAAhBC,MAAgB,GAAhBA,MAAgB;AAAA,kDAFvE,gBAEuE;AAAA,sDADrD,KACqD;AAAE;;AAE5E,QAAPC,OAAO,CAACC,OAAD,EAAkD;AAC7D,UAAMC,QAAQ,GAAGD,OAAO,CAACE,cAAR,CAAuBC,eAAxC;AACA,SAAKL,MAAL,CAAYM,IAAZ,CAAkB,wBAAuBH,QAAQ,CAACI,MAAO,WAAzD;AACA,UAAMC,WAAW,GAAG,MAAM,KAAKT,MAAL,CAAYU,oBAAZ,CAAiCN,QAAjC,EAA2C;AAAEO,MAAAA,QAAQ,EAAE;AAAZ,KAA3C,EAA+D,KAA/D,EAAsE,IAAtE,CAA1B;AACA,UAAMC,iBAAiB,GAAG,KAAKZ,MAAL,CAAYa,uBAAZ,EAA1B;AAEA,WAAO;AACLC,MAAAA,iBAAiB,EAAEL,WADd;AAELM,MAAAA,SAAS,EAAE,CAACH,iBAAD;AAFN,KAAP;AAID;;AAfwC","sourcesContent":["import { BuildContext, BuiltTaskResult, BuildTask, TaskLocation } from '@teambit/builder';\nimport { Logger } from '@teambit/logger';\nimport { Packer } from './packer';\n\n/**\n * pack components to a .tgz file\n */\nexport class PackTask implements BuildTask {\n  readonly name = 'PackComponents';\n  readonly location: TaskLocation = 'end';\n  constructor(readonly aspectId: string, private packer: Packer, private logger: Logger) {}\n\n  async execute(context: BuildContext): Promise<BuiltTaskResult> {\n    const capsules = context.capsuleNetwork.seedersCapsules;\n    this.logger.info(`going to run pack on ${capsules.length} capsules`);\n    const packResults = await this.packer.packMultipleCapsules(capsules, { override: true }, false, true);\n    const packArtifactsDefs = this.packer.getArtifactDefInCapsule();\n\n    return {\n      componentsResults: packResults,\n      artifacts: [packArtifactsDefs],\n    };\n  }\n}\n"]}